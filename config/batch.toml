# Batch Generation Configuration
# Generate multiple videos with randomized parameters

include = ["best_params.toml"]

[batch]
output_directory = "batch_output"
count = 100                              # Number of videos to generate
base_config = "config/batch_template.toml"  # Base parameters for non-randomized values
presets = "config/presets.toml"          # Preset library file

[probe]
enabled = true           # Enable probe-based filtering
pendulum_count = 1000    # Fast probing with fewer pendulums (no rendering)
total_frames = 200       # Fewer frames for faster probing (0 = use base_config)
# max_dt = 0.01            # Larger timestep for faster probing (0 = use base_config)
max_retries = 10000000       # Retry with new params if probe fails
physics_quality = "medium"

[probe.phase2]
enabled = true
pendulum_count = 2000
socket = "/home/holo/prog/boom-detection/sock"  # Path to Unix socket where boom_server.py is listening

[physics_ranges]
# Random initial angles (in degrees)
initial_angle1_deg = [150.0, 180.0]
initial_angle2_deg = [-180.0, 180.0]
# Random angle variation (in degrees)
angle_variation_deg = [0.001, 0.05]
# Random initial velocities (rad/s) - small values for variety
initial_velocity1 = [-0.2, 0.2]
initial_velocity2 = [-0.2, 0.2]


[filter]
# General constraints (non-target)
min_uniformity = 0.9       # Minimum distribution uniformity (0=concentrated, 1=uniform)

# Target-based constraints (reference [targets.X] by name)
[filter.targets.boom]
min_seconds = 6.0          # Boom must happen after this time
max_seconds = 12.0         # Boom must happen before this time
required = true            # Reject simulations with no detectable boom

[filter.targets.boom_quality]
min_score = 0.0001          # Minimum quality score for boom

# Randomization settings - which presets to randomly select from
# Names must match presets defined in the preset library
[randomize]
color_presets = [
  "full_spectrum",
  "vibrant",
  "fire",
  "ice",
  "rainbow",
  "sunset_dusk",
  "plasma_warm",
  "viridis_bright"
]

post_process_presets = [
  "default",
  "cinematic",
  "filmic",
  "crisp",
  "glassy",
  "studio_neutral",
  "vibrant"
]

# Remote transfer settings (SCP to a queue server)
# Videos are transferred immediately after generation for remote processing/upload.
# Enable this to use a Raspberry Pi or similar as a queue server.
[transfer]
enabled = false
host = "pi@raspberrypi.local"           # SSH host (user@host or just host)
remote_path = "/home/pi/pendulum-watch" # Destination directory on remote
# identity_file = "~/.ssh/id_rsa"       # Optional: SSH key path (~ is expanded)
# delete_after_transfer = false         # Optional: Delete local files after successful transfer
# timeout_seconds = 300                 # Optional: SCP timeout (default 300)
